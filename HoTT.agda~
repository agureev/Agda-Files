{-# OPTIONS --without-K --exact-split #-}
 

open import Agda.Primitive using (Level; lzero; lsuc; _âŠ”_; SetÏ‰)

Type : (i : Level) â†’ Set (lsuc i)
Type i = Set i

const-type-fam : {l1 l2 : Level} {A : Type l1} (C : Type l2)  â†’ (A â†’ Type l2)
const-type-fam C = Î» a â†’ C

data â„• : Type lzero where
  zero : â„• 
  succ : â„• â†’ â„•


indâ„• :  {l : Level} (C : â„• â†’ Type l) â†’ (C (zero)) â†’ ( (n : â„•) â†’ (C n â†’ (C (succ n)))) â†’ ( (n : â„•) â†’ C n)
indâ„• C p f zero = p 
indâ„• C p f (succ n) = f n (indâ„• C p f n) 

data Bool : Type lzero where
  true : Bool
  false : Bool

indğŸš : âˆ€ {l} {C : Bool â†’ Type l} â†’ (C true) â†’ (C false) â†’ (âˆ€ (c : Bool) â†’ C c)
indğŸš p q true = p
indğŸš p q false = q

data Empty : Type lzero where

indğŸ˜ : âˆ€ {l} {C : Empty â†’ Type l} â†’ (âˆ€ (x : Empty) â†’ C x)
indğŸ˜ ()

ğŸ˜ : Type lzero
ğŸ˜ = Empty

data ğŸ™ : Type lzero where
  pt : ğŸ™

indğŸ™ : âˆ€ {l} (C : ğŸ™ â†’ Type l) â†’ (C pt) â†’ (âˆ€ (x : ğŸ™) â†’ C x)
indğŸ™ C H pt = H

data _+_ {l1 l2}(A : Type l1) (B : Type l2) : Set (l1 âŠ” l2) where
    inl : A â†’ A + B
    inr : B â†’ A + B

rec+ : {l1 l2 l3 : Level}  {A : Type l1} {B : Type l2 } {C : Type l3 } â†’
    (A â†’ C) â†’ (B â†’ C) â†’ (A + B â†’ C)
rec+ f g (inl x) = f x
rec+ f g (inr x) = g x

ind+ : {l1 l2 l3 : Level} {A : Type l1 } {B : Type l2 } (C :  A + B  â†’ Type l3 ) â†’ 
        ( (a : A) â†’ C (inl a)) â†’ ( (b : B) â†’ (C (inr b)) ) â†’ ((c : A + B) â†’ (C c))
ind+ C f g (inl x) = f x
ind+ C f g (inr x) = g x


data _Ã—_ {l1 l2} (A : Type l1) (B : Type l2) : Type (l1 âŠ” l2) where
  pair : A â†’ B â†’ A Ã— B

recÃ— : {l1 l2 l3 : Level} {A : Type l1} {B : Type l2} (C : Type l3) â†’ 
   (A â†’ B â†’ C) â†’ (A Ã— B â†’ C)
recÃ— C f (pair x xâ‚) = f x xâ‚

indÃ— : {l1 l2 l3 : Level} {A : Type l1} {B : Type l2} (C : A Ã— B â†’ Type l3) â†’ 
  ( (a : A) â†’ âˆ€ (b : B) â†’ C(pair a b)) â†’ ( (x : A Ã— B) â†’ C(x))
indÃ— C f (pair x xâ‚) = f x xâ‚

data Î£ {l1 l2 : Level} (A : Type l1) (B : A â†’ Type l2) : Type (l1 âŠ” l2) where
  deppair :  (x : A) â†’ B x â†’ Î£ A B

_,,_ :  {l1 l2 : Level} {A : Type l1} {B : A â†’ Type l2} (x : A) â†’ B x â†’ Î£ A B
x ,, y = deppair x y

Î£-recursion :  {l1 l2 l3 : Level} {A : Type l1} {B : A â†’ Type l2} (C : Type l3) â†’ 
                                                 (âˆ€ (a : A) â†’ B a â†’ C) â†’ (Î£ A B â†’ C)
Î£-recursion C f (deppair x xâ‚) = f x xâ‚


Î£-induction : {l1 l2 l3 : Level} {A : Type l1} {B : A â†’ Type l2} (C : (Î£ A B) â†’ Type l3) â†’ 
                                   (âˆ€ (a : A) â†’ âˆ€ (b : B a) â†’ (C (deppair a b))) â†’ (âˆ€ (x : Î£ A B) â†’ C x)
Î£-induction C f (deppair x xâ‚) = f x xâ‚

data Con : Type lzero
data Ty : Con â†’ Type lzero

data Con where
 âŠ¥ : Con
 _,,,_ : (Î“ : Con) â†’ Ty Î“ â†’ Con 

data Ty where 
 U : âˆ€ {Î“} â†’ Ty Î“
 Î  : âˆ€ {Î“} (A : Ty Î“) (B : Ty (Î“ ,,, A)) â†’ Ty Î“



data _â‰¡_ {l1} {A : Type l1} :  A â†’ A â†’ Type l1  where
  refl : âˆ€ (a : A) â†’  a â‰¡ a

indâ‰¡ : {l1 l2 : Level}  {A : Type l1 } (C : âˆ€ {x y : A} -> ( (x â‰¡ y) -> (Type l2) )) â†’ ( âˆ€ (x : A) â†’ (C (refl x)) ) â†’ (forall  {a b : A}  (p : a â‰¡ b) â†’ (C p) )
indâ‰¡ C f (refl x) = f x

recâ‰¡ : {l1 l2 : Level} {A : Type l1 } (C : Type l2) â†’ ( âˆ€ (x : A) â†’ C ) â†’ (forall  ( a b : A)  (p : a â‰¡ b) â†’ C )
recâ‰¡ C x a .a (refl .a) = x a

inv-path : {l1 : Level} {A : Type l1} {a b : A} (p : a â‰¡ b)  â†’  b â‰¡ a
inv-path (refl _) = refl _

_â»Â¹ : {l1 : Level} {A : Type l1} {a b : A} (p : a â‰¡ b) â†’ b â‰¡ a
(refl _)â»Â¹ = refl _ 

concat : {l1 : Level} {A : Type l1} {x y z : A} â†’  x â‰¡ y â†’ y â‰¡ z â†’ x â‰¡ z
concat (refl _) q = q

add-â„• :  â„•  â†’  â„•  â†’  â„• 
add-â„• zero m = m
add-â„• (succ n) m = succ (add-â„• n m)

mult-â„• : â„• â†’ â„• â†’ â„•
mult-â„• zero m = zero
mult-â„• (succ n) m = add-â„• (mult-â„• n m) m

max-â„• : â„• â†’ â„• â†’ â„•
max-â„• zero m = m
max-â„• (succ n) zero = succ n
max-â„• (succ n) (succ m) = succ (max-â„• n m) 

min-â„• : â„• â†’ â„• â†’ â„•
min-â„• zero m = zero
min-â„• (succ n) zero = zero
min-â„• (succ n) (succ m) = succ (min-â„• n m)

pred : â„• â†’ â„•
pred zero = zero
pred (succ n) = n

Â¬_ : {l1 : Level} â†’ Type l1 â†’ Type l1
Â¬ A = A â†’ Empty

neg-Bool : Bool â†’ Bool
neg-Bool true = false
neg-Bool false = true

_âˆ§_ : Bool â†’ Bool â†’ Bool
false âˆ§ b2 = false
true âˆ§ true = true
true âˆ§ false = false

_âˆ¨_ : Bool â†’ Bool â†’ Bool
true âˆ¨ b2 = true
false âˆ¨ true = true
false âˆ¨ false = false

_â†”_ : {l1 l2 : Level} â†’  Type l1 â†’ Type l2 â†’ Type (l1 âŠ” l2)
A â†” B = (A â†’ B) Ã— (B â†’ A)

data list {l1 : Level} (A : Type l1) :  Type l1  where
  nil :  list A
  cons : A â†’ (list A) â†’ (list A)


fold-list : {l1 : Level} {A B : Type l1} â†’ B â†’  (A â†’ B â†’ B) â†’ (list A â†’ B)
fold-list b Î¼ nil = b
fold-list b Î¼ (cons x l) = Î¼ x (fold-list b Î¼ l)

map-list : {l1 : Level} {A B : Type l1} â†’ (A â†’ B) â†’ (list A â†’ list B)
map-list f nil = nil
map-list f (cons x l) = cons (f x) (map-list f l)

concat-list : {l1 : Level} {A : Type l1} â†’ list A â†’ list A â†’ list A
concat-list nil l2 = l2
concat-list (cons x l1) l2 = cons x (concat-list l1 l2)

flatten-list : {l1 : Level} {A : Type l1} â†’ list (list A) â†’ list A
flatten-list nil = nil
flatten-list (cons nil lâ‚) = flatten-list lâ‚
flatten-list (cons (cons x l) lâ‚) = cons x (flatten-list (cons l lâ‚))

_Â·_ : {l1 : Level} {A : Type l1}  {x y z : A} â†’  (x â‰¡ y) â†’ (y â‰¡ z) â†’ (x â‰¡ z)
p Â· q = concat p q

concat-assoc : {l1 : Level} {A : Type l1} {x y z w : A} (p : x â‰¡ y) (q : y â‰¡ z) (t : z â‰¡ w) â†’  (( (p Â· q ) Â· t ) â‰¡  ( p Â· (q Â· t)))
concat-assoc (refl _) (refl _) t = refl t

refl-l : âˆ€ {A : Set} {x y  : A } (p : x  â‰¡ y) â†’  ((refl x) Â· p) â‰¡ p
refl-l (refl _) = refl _

refl-r : âˆ€ {A : Set} {x y : A} (p : x â‰¡ y) â†’ (p Â· (refl y)) â‰¡ p
refl-r (refl _) = refl _

left-inv : âˆ€ {A : Set} {x y : A} (p : x â‰¡ y) â†’ ((inv-path p) Â·  p) â‰¡ (refl _)
left-inv (refl _) = refl _

right-inv :  âˆ€ {A : Set} {x y : A} (p : x â‰¡ y) â†’ (p Â· (inv-path p)) â‰¡ (refl _)
right-inv (refl _) = refl _

fun-ap : âˆ€ {A B : Set} {x y : A} (f : A â†’ B) (p : x â‰¡ y) â†’ (f x) â‰¡ (f y)
fun-ap f (refl _) = refl _

_âˆ˜_ : âˆ€ {A B C : Set} â†’ (B â†’ C) â†’ (A â†’ B) â†’ (A â†’ C)
(g âˆ˜ f) x = g (f x)

id : âˆ€ (A : Set) â†’ A â†’ A
id A x = x

ap-id : âˆ€ {A : Set} {x y : A} (p : x â‰¡ y) â†’ p â‰¡ (fun-ap (id A ) p)
ap-id (refl x) = refl _

ap-comp : âˆ€ {A B C : Set} {x y : A} (p : x â‰¡ y) (f : A â†’ B) (g : B â†’ C) â†’ (fun-ap g (fun-ap f p)) â‰¡ (fun-ap (g âˆ˜ f) p)
ap-comp (refl x) f g = refl _


ap-refl : âˆ€ {A B : Set} {x : A} (f : A â†’ B) â†’ (fun-ap f (refl x)) â‰¡ (refl (f x))
ap-refl f = refl _

ap-inv : âˆ€ {A B : Set} {x y : A} (p : x â‰¡ y) (f : A â†’ B) â†’ (fun-ap f (inv-path p)) â‰¡ (inv-path (fun-ap f p))
ap-inv (refl _) f = refl _

ap-concat : âˆ€ {A B : Set} {x y z : A} (p : x â‰¡ y) (q : y â‰¡ z) (f : A â†’ B)  â†’ (fun-ap f (p Â· q)) â‰¡ ( (fun-ap f p) Â· (fun-ap f q))
ap-concat (refl _) q f = refl _

transp : âˆ€ {A : Set} (B : A â†’ Set)  {x y : A}  â†’  (x â‰¡ y) â†’ B x â†’ B y
transp B (refl x) z = z

fun-ap-dep : âˆ€ {A : Set} {B : A â†’ Set} (f : âˆ€ (x : A) â†’ B x) {x y : A}  (p : x â‰¡ y) â†’  (transp B p (f x)) â‰¡ (f y)
fun-ap-dep f (refl _) = refl _

id-Î£-type-endpoint : âˆ€ {A : Set} (a : A) (y : Î£ A (Î» x â†’ a â‰¡ x))   â†’  (deppair a (refl a)) â‰¡ y
id-Î£-type-endpoint a (deppair .a (refl .a)) = refl _

_+â„•_ : â„• â†’ â„• â†’ â„•
n +â„• m = add-â„• n m

infixl 1 _â‰¡_

left-unit-law-add-â„• : âˆ€ (n : â„•) â†’ ((zero +â„• n) â‰¡ n)
left-unit-law-add-â„• n = refl _ 


right-unit-law-add-â„• : âˆ€ ( n : â„•) â†’ (n +â„• zero â‰¡ n)
right-unit-law-add-â„• zero = refl _
right-unit-law-add-â„• (succ n) = fun-ap succ (right-unit-law-add-â„• n)

left-succ-law-add-â„• : âˆ€ (m n : â„•) â†’ ((succ m) +â„• n â‰¡ succ (m +â„• n))
left-succ-law-add-â„• m n = refl _

right-succ-law-add-â„• : âˆ€ (m n : â„•) â†’ (m +â„• (succ n) â‰¡ succ (m +â„• n))
right-succ-law-add-â„• zero n =  fun-ap succ (inv-path (left-unit-law-add-â„• n)) 
right-succ-law-add-â„• (succ m) n = fun-ap succ (right-succ-law-add-â„• m n)

assoc-add-â„• : âˆ€ (m n k : â„•) â†’ (m +â„• n) +â„• k â‰¡ m +â„• (n +â„• k)
assoc-add-â„• zero n k = refl _
assoc-add-â„• (succ m) n k = fun-ap succ (assoc-add-â„• m n k)


commutative-add-â„• : âˆ€ (m n : â„•) â†’ m +â„• n â‰¡ n +â„• m
commutative-add-â„• zero n = inv-path (right-unit-law-add-â„• n)
commutative-add-â„• (succ m) n = concat (fun-ap succ (commutative-add-â„• m n))  (inv-path (right-succ-law-add-â„• n m))

distributive-inv-concat : âˆ€ {A : Set} {x y z : A} (p : x â‰¡ y) (q : y â‰¡ z) â†’ inv-path (p Â· q) â‰¡ (inv-path q) Â· (inv-path p)
distributive-inv-concat (refl _) q = concat (refl-l (inv-path (q))) (concat (refl _) (inv-path  (refl-r (inv-path q))))

inv-con : âˆ€ {A : Set} {x y z : A} (p : x â‰¡ y) (q : y â‰¡ z) (r : x â‰¡ z) â†’ (p Â· q â‰¡ r) â†’ (q â‰¡ (inv-path p) Â· r)
inv-con (refl x) q r t = concat t (refl r)

path-uniq-inv : âˆ€ {A : Set} {x y : A} (p : x â‰¡ y) (q : y â‰¡ x) â†’ (p Â· q â‰¡ (refl _)) â†’ (q â‰¡ inv-path p)
path-uniq-inv (refl _) q r = concat r (refl _)


con-inv :  âˆ€ {A : Set} (x y z : A) (p : x â‰¡ y) (q : y â‰¡ z) (r : x â‰¡ z) â†’ (p Â· q â‰¡ r) â†’ (p â‰¡ r Â· (inv-path q))
con-inv x y z (refl x) q r t = concat (inv-path (right-inv q)) (fun-ap (Î» l â†’ (l Â· (inv-path q))) t)


lift : âˆ€ {A : Set} (B : A â†’ Set) {a x : A} (p : a â‰¡ x) (b : B a) â†’ deppair a b â‰¡ deppair x (transp B p b)
lift B (refl x) b = refl _

_Â·â„•_ : â„• â†’ â„• â†’ â„•
m Â·â„• n = mult-â„• m n

zero-mult-r-â„• : âˆ€ (m : â„•) â†’ m Â·â„• zero â‰¡ zero
zero-mult-r-â„• zero = refl _
zero-mult-r-â„• (succ m) = concat (right-unit-law-add-â„• (m Â·â„• zero)) (zero-mult-r-â„• m)

zero-mult-l-â„• : âˆ€ (m : â„•) â†’ zero Â·â„• m â‰¡ zero
zero-mult-l-â„• m = refl _

one : â„•
one = succ zero

one-mult-r-â„• : âˆ€ (m : â„•) â†’ m Â·â„• one â‰¡ m
one-mult-r-â„• zero = zero-mult-l-â„• one
one-mult-r-â„• (succ m) = concat (right-succ-law-add-â„• (m Â·â„• one) (zero)) (fun-ap succ (concat (right-unit-law-add-â„• (m Â·â„• one)) (one-mult-r-â„• m)))

one-mult-l-â„• : âˆ€ (m : â„•) â†’ one Â·â„• m â‰¡ m
one-mult-l-â„• zero = zero-mult-r-â„• one
one-mult-l-â„• (succ m) = concat (fun-ap (Î» (x : â„•) â†’ x +â„• succ m) (zero-mult-l-â„• (succ m))) (left-unit-law-add-â„• (succ m))

succ-mult-right : âˆ€ (m n : â„•) â†’ m Â·â„• (succ n) â‰¡ m +â„• (m Â·â„• n)
succ-mult-right zero n = concat (inv-path (right-unit-law-add-â„• zero)) (inv-path (zero-mult-l-â„• n))
succ-mult-right (succ m) n = concat (right-succ-law-add-â„• (m Â·â„• (succ n)) n) (fun-ap succ (concat (concat (fun-ap (Î» x â†’ x +â„• n) (succ-mult-right m n)) (assoc-add-â„• m (m Â·â„• n) n)) (refl _)))

-- One extra concat, need to remove

succ-mult-left : âˆ€ (m n : â„•) â†’ (succ m) Â·â„• n â‰¡ (m Â·â„• n) +â„• n
succ-mult-left m n = refl _

mult-â„•-commutative : âˆ€ (m n : â„•) â†’ m Â·â„• n â‰¡ n Â·â„• m
mult-â„•-commutative zero n = inv-path (zero-mult-r-â„• n)
mult-â„•-commutative (succ m) n = concat (concat (fun-ap (Î» x â†’ x +â„• n) (mult-â„•-commutative m n)) (commutative-add-â„• (n Â·â„• m) n)) (inv-path (succ-mult-right n m))

mult-â„•-distrib-left : âˆ€ (m n k : â„•) â†’ m Â·â„• (n +â„• k) â‰¡ (m Â·â„• n) +â„• (m Â·â„• k)
mult-â„•-distrib-left zero n k = right-unit-law-add-â„• zero
mult-â„•-distrib-left (succ m) n k = ((((fun-ap (Î» x â†’ ( x +â„• (n +â„• k))) (mult-â„•-distrib-left m n k )) Â· inv-path (assoc-add-â„• ( (m Â·â„• n) +â„• (m Â·â„• k)) n k)) Â· ((fun-ap (Î» x â†’ x +â„• k) (assoc-add-â„• (m Â·â„• n) (m Â·â„• k) n)) Â· (fun-ap (Î» x â†’ ((m Â·â„• n) +â„• x) +â„• k) (commutative-add-â„• ((m Â·â„• k)) n)))) Â· fun-ap (Î» x â†’ x +â„• k) ( inv-path (assoc-add-â„• (m Â·â„• n) (n) (m Â·â„• k)))) Â· assoc-add-â„• ((m Â·â„• n) +â„• n) (m Â·â„• k) k


mult-â„•-distrib-right : âˆ€ (m n k : â„•) â†’ (m +â„• n) Â·â„• k â‰¡ (m Â·â„• k) +â„• (n Â·â„• k)
mult-â„•-distrib-right m n k = mult-â„•-commutative (m +â„• n) k  Â· (mult-â„•-distrib-left k m n Â· (fun-ap (Î» x â†’ x +â„• (k Â·â„• n)) (mult-â„•-commutative k m) Â· fun-ap (Î» x â†’ (m Â·â„• k) +â„• x) (mult-â„•-commutative k n)))


mult-â„•-assoc : âˆ€ (m n k : â„•) â†’ (m Â·â„• n) Â·â„• k â‰¡ m Â·â„• (n Â·â„• k)
mult-â„•-assoc zero n k = refl _
mult-â„•-assoc (succ m) n k = (mult-â„•-distrib-right (m Â·â„• n) n k) Â· (fun-ap (Î» x â†’ x +â„• (n Â·â„• k)) (mult-â„•-assoc m n k))

Eqâ„• : âˆ€ (n m : â„•) â†’ Set
Eqâ„• zero zero = ğŸ™
Eqâ„• zero (succ m) = ğŸ˜
Eqâ„• (succ n) zero = ğŸ˜
Eqâ„• (succ n) (succ m) = Eqâ„• n m

refl-Eqâ„• : âˆ€ (n : â„•) â†’ Eqâ„• n n
refl-Eqâ„• zero = pt
refl-Eqâ„• (succ n) = refl-Eqâ„• n

â„•-eq-iff-Eqâ„• : âˆ€ (m n : â„•) â†’ ( (m â‰¡ n) â†” Eqâ„• m n)
â„•-eq-iff-Eqâ„• m n  = pair {!Î» p !} {!!}
